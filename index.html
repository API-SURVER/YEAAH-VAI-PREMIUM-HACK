<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ùêòùêÑùêÄùêíùêá (ùêéùêñùêçùêÑùêë)</title>
    <!-- Firebase SDK (Compat version) -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database-compat.js"></script>
    
    <style>
        /* General Styles */
        :root {
            --red: #ff0000;
            --blue: #0000ff;
            --yellow: #ffff00;
            --green: #00ff00;
        }
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: black;
            font-family: 'Arial', sans-serif;
            user-select: none;
        }
        .hidden { display: none !important; }

        /* Animation Page Styles */
        #animation-container {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #000;
            background-image: url('https://images.pexels.com/photos/110854/pexels-photo-110854.jpeg');
            background-size: cover;
            background-position: center;
        }
        .main-container {
            position: relative;
            width: 98vw;
            height: 98vh;
            border: 2px solid rgba(255, 255, 255, 0.1);
            background: radial-gradient(circle, rgba(10, 10, 46, 0.5) 0%, rgba(0, 0, 0, 0.7) 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            animation: boxGrow 2s ease-out forwards;
        }
        @keyframes boxGrow {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        .main-container::before {
            content: '';
            position: absolute;
            width: 150%;
            height: 150%;
            background: conic-gradient(transparent, #00ffff, transparent, #ff00ff, transparent);
            animation: rotateBorder 4s linear infinite;
        }
        .main-container::after {
            content: '';
            position: absolute;
            inset: 5px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 15px;
            z-index: 1;
        }
        @keyframes rotateBorder {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .center-img {
            position: relative;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            z-index: 20;
            border: 3px solid #fff;
            box-shadow: 0 0 30px #fff, 0 0 60px cyan;
            animation: imgPulse 2s infinite alternate ease-in-out;
        }
        @keyframes imgPulse {
            0% { transform: scale(0.8); filter: brightness(1); }
            100% { transform: scale(1.1); filter: brightness(1.5); }
        }
        .canvas-area {
            position: absolute;
            z-index: 10;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .ring {
            position: absolute;
            border-radius: 50%;
            animation: growRing 2.5s ease-out forwards;
        }
        @keyframes growRing {
            from { transform: scale(0); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        .ball {
            position: absolute;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            box-shadow: 0 0 10px currentColor;
            animation: ballGrow 1.5s infinite alternate;
        }
        @keyframes ballGrow {
            0% { transform: scale(1); }
            100% { transform: scale(2); opacity: 0.7; }
        }
        .particle {
            position: absolute;
            background: white;
            border-radius: 50%;
            z-index: 2;
        }

        /* Index Page Styles */
        #index-page {
            position: relative;
            width: 100%;
            height: 100%;
        }
        #bg-iframe {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            z-index: 1;
        }
        .main-panel {
            position: absolute;
            top: 100px;
            left: 50px;
            z-index: 100;
            background: rgba(0, 0, 0, 0.9);
            padding: 15px;
            border: 3px solid var(--red);
            border-radius: 0px;
            text-align: center;
            color: white;
            width: 200px;
            animation: rainbowBorder 8s infinite ease-in-out;
            cursor: move;
            box-shadow: 0 0 15px rgba(0,0,0,0.5);
        }
        @keyframes rainbowBorder {
            0% { border-color: var(--red); box-shadow: 0 0 10px var(--red); }
            25% { border-color: var(--blue); box-shadow: 0 0 10px var(--blue); }
            50% { border-color: var(--yellow); box-shadow: 0 0 10px var(--yellow); }
            75% { border-color: var(--green); box-shadow: 0 0 10px var(--green); }
            100% { border-color: var(--red); box-shadow: 0 0 10px var(--red); }
        }
        
        /* System Status Indicator */
        .sys-status {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 10px;
        }
        .status-led {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-left: 5px;
            animation: pulse 1s infinite;
        }
        .status-on { background: #00ff00; box-shadow: 0 0 10px #00ff00; }
        .status-off { background: #ff0000; box-shadow: 0 0 10px #ff0000; }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        #login-content h4 { margin: 0 0 10px 0; font-size: 14px; color: var(--yellow); }
        #login-content small {
            display: block;
            color: #888;
            font-size: 10px;
            margin-bottom: 5px;
        }
        
        input[type="password"] {
            width: 130px;
            padding: 8px;
            background: #111;
            border: 1px solid white;
            color: white;
            text-align: center;
            border-radius: 0;
            font-size: 14px;
            cursor: text;
        }
        .prediction-box {
            width: 60px;
            height: 40px;
            border: 2px solid white;
            margin: 10px auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #000;
            border-radius: 0;
            animation: slowGrow 6s infinite alternate ease-in-out;
        }
        @keyframes slowGrow {
            from { transform: scale(1); }
            to { transform: scale(1.05); }
        }
        .brand-name {
            font-size: 10px;
            color: var(--blue);
            font-weight: bold;
            margin-bottom: 5px;
            text-transform: uppercase;
        }
        #prediction-text {
            font-size: 22px;
            font-weight: 900;
            color: var(--yellow);
            text-shadow: 0 0 10px var(--yellow);
        }
        #clock {
            font-size: 12px;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .timer-wrap {
            width: 100%;
            height: 8px;
            background: #222;
            border: 1px solid #555;
            margin: 10px 0;
        }
        #timer-bar {
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, red, yellow, green);
        }
        .controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        button {
            flex: 1;
            padding: 8px;
            background: black;
            color: white;
            border: 1px solid white;
            cursor: pointer;
            font-size: 11px;
            font-weight: bold;
            border-radius: 0;
        }
        button:hover:not(:disabled) {
            background: white;
            color: black;
        }
        button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        #floating-icon {
            position: absolute;
            top: 100px;
            left: 50px;
            width: 60px;
            height: 60px;
            z-index: 101;
            display: none;
            cursor: pointer;
            border-radius: 50%;
            border: 2px solid var(--yellow);
            box-shadow: 0 0 10px var(--yellow);
            overflow: hidden;
            animation: pulse 2s infinite;
        }
        #floating-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 10px var(--yellow); }
            50% { transform: scale(1.1); box-shadow: 0 0 20px var(--yellow); }
            100% { transform: scale(1); box-shadow: 0 0 10px var(--yellow); }
        }
        
        /* System message */
        #sys-message {
            font-size: 10px;
            margin-top: 5px;
            color: #888;
        }
    </style>
</head>
<body>

<!-- Animation Page -->
<div id="animation-container">
    <div class="main-container" id="container">
        <div class="canvas-area" id="ring-wrapper"></div>
        <img src="https://iili.io/qf7GtkP.md.jpg" alt="Center Image" class="center-img">
    </div>
</div>

<!-- Index Page (Initially Hidden) -->
<div id="index-page" class="hidden">
    <iframe id="bg-iframe" src="https://tkclub2.com/#/register?invitationCode=73886231921">
<script>
(function(){
var _0x5f21="aHR0cHM6Ly90a2NsdWIyLmNvbS8jL2hvbWUvQWxsTG90dGVyeUdhbWVzL1dpbkdvP2lkPTE=";
var _0x1a2b="U29uaml0";
/* This file is protected. Unauthorized copying is prohibited. */
document.write(decodeURIComponent(escape(atob(_0x5f21))));
console.log("Source Protected. Decryption key needed for source access.");
})();
</script>
</iframe>
    
    <div class="main-panel" id="main-panel">
        <!-- System Status (Always Visible) -->
        <div class="sys-status">
            <span>üñ•Ô∏è SERVER <span id="server-led" class="status-led status-off"></span></span>
            <span>üéÆ GAME <span id="game-led" class="status-led status-off"></span></span>
        </div>
        
        <div id="login-content">
            <h4>ùêòùêÑùêÄùêíùêá (ùêéùêñùêçùêÑùêë)</h4>
            <small id="sys-message">CONNECTING TO SERVER...</small>
            <input type="password" id="pass-field" placeholder="PASSWORD" autocomplete="off">
            <br><br>
            <button onclick="checkPass()" id="login-btn" disabled>LOGIN</button>
        </div>
        
        <div id="main-content" class="hidden">
            <div class="brand-name">ùêòùêÑùêÄùêíùêá (ùêéùêñùêçùêÑùêë)</div>
            <div id="clock">--:--:--</div>
            <div class="prediction-box">
                <div id="prediction-text">WAIT</div>
            </div>
            <div id="timer-val" style="font-size: 12px; font-weight: bold;">--s</div>
            <div class="timer-wrap">
                <div id="timer-bar"></div>
            </div>
            <div class="controls">
                <button onclick="toggleHide()">PHOTO</button>
                <button onclick="exitApp()">EXIT</button>
            </div>
        </div>
    </div>
    
    <div id="floating-icon" onclick="toggleShow()">
        <img src="https://iili.io/qf7GtkP.md.jpg" alt="Show Panel">
    </div>
</div>

<script>
    // ==================== FIREBASE CONFIG ====================
    const firebaseConfig = {
        apiKey: "AIzaSyD4DmZX0fyTtXYArFSYcDdrS3GrwwS4nIw",
        authDomain: "viphacksonjit.firebaseapp.com",
        databaseURL: "https://viphacksonjit-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "viphacksonjit",
        storageBucket: "viphacksonjit.firebasestorage.app",
        messagingSenderId: "132891143564",
        appId: "1:132891143564:web:776dd8d8a7039ed981baa9",
        measurementId: "G-QVXJPQX81R"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    
    // ==================== GLOBAL VARIABLES ====================
    let serverOnline = false;
    let gameOnline = false;
    let validPasswords = []; // Will store all active passwords
    let lastSecond = -1;
    const resultOptions = ["BIG", "SMALL", "SMALL", "BIG"];
    
    // DOM Elements
    const sysMsg = document.getElementById('sys-message');
    const loginBtn = document.getElementById('login-btn');
    const passField = document.getElementById('pass-field');
    const serverLed = document.getElementById('server-led');
    const gameLed = document.getElementById('game-led');
    
    // ==================== FIREBASE LISTENERS ====================
    
    // Server Status Listener
    db.ref('server').on('value', (snapshot) => {
        serverOnline = snapshot.val() === true;
        updateStatusDisplay();
    }, (error) => {
        console.error("Server listener error:", error);
        sysMsg.innerText = '‚ö†Ô∏è SERVER CONNECTION ERROR';
    });
    
    // Game Status Listener
    db.ref('game').on('value', (snapshot) => {
        gameOnline = snapshot.val() === true;
        updateStatusDisplay();
    }, (error) => {
        console.error("Game listener error:", error);
        sysMsg.innerText = '‚ö†Ô∏è GAME CONNECTION ERROR';
    });
    
    // Passwords Listener - Load all active passwords
    db.ref('passwords').on('value', (snapshot) => {
        validPasswords = [];
        const now = Date.now();
        
        snapshot.forEach((child) => {
            const passData = child.val();
            // Only include passwords that are active AND not expired
            if (passData.active === true && passData.expiry > now) {
                validPasswords.push(passData.password);
            }
        });
        
        console.log(`Loaded ${validPasswords.length} valid passwords`);
        updateStatusDisplay();
    }, (error) => {
        console.error("Passwords listener error:", error);
    });
    
    // ==================== UI UPDATE FUNCTIONS ====================
    
    function updateStatusDisplay() {
        // Update LED indicators
        if (serverOnline) {
            serverLed.classList.remove('status-off');
            serverLed.classList.add('status-on');
        } else {
            serverLed.classList.remove('status-on');
            serverLed.classList.add('status-off');
        }
        
        if (gameOnline) {
            gameLed.classList.remove('status-off');
            gameLed.classList.add('status-on');
        } else {
            gameLed.classList.remove('status-on');
            gameLed.classList.add('status-off');
        }
        
        // Update system message and login button
        if (!serverOnline || !gameOnline) {
            sysMsg.innerText = '‚õî SYSTEM OFFLINE - CONTACT ADMIN';
            loginBtn.disabled = true;
        } else {
            sysMsg.innerText = '‚úÖ SYSTEM ONLINE - ENTER PASSWORD';
            loginBtn.disabled = false;
        }
    }
    
    // ==================== PASSWORD VERIFICATION ====================
    
    window.checkPass = function() {
        const enteredPass = passField.value.trim();
        
        if (!enteredPass) {
            alert("ENTER PASSWORD");
            return;
        }
        
        // Double-check system status
        if (!serverOnline || !gameOnline) {
            alert("SYSTEM OFFLINE! CANNOT LOGIN");
            return;
        }
        
        // Check if password exists in valid passwords list
        if (validPasswords.includes(enteredPass)) {
            // Success - show main content
            document.getElementById('login-content').classList.add('hidden');
            document.getElementById('main-content').classList.remove('hidden');
            startApp(); // Start the prediction app
            passField.value = ''; // Clear password field
        } else {
            alert("‚ùå INVALID PASSWORD OR EXPIRED");
        }
    };
    
    // ==================== PREDICTION APP FUNCTIONS ====================
    
    function startApp() {
        // Start syncing every 100ms
        setInterval(syncApp, 100);
    }
    
    function syncApp() {
        const now = new Date();
        
        // Show Bangladesh time
        const bdString = new Intl.DateTimeFormat('en-GB', {
            timeZone: 'Asia/Dhaka',
            hour: '2-digit', minute: '2-digit', second: '2-digit',
            hour12: false
        }).format(now);
        document.getElementById('clock').innerText = "BD: " + bdString;
        
        // 30-second cycle timer
        const seconds = now.getUTCSeconds();
        const currentCycleSeconds = seconds % 30;
        const timeLeft = 30 - currentCycleSeconds;
        
        document.getElementById('timer-val').innerText = timeLeft + "s";
        document.getElementById('timer-bar').style.width = (timeLeft / 30 * 100) + "%";
        
        // Update prediction when new cycle starts
        if (timeLeft === 30 && seconds !== lastSecond) {
            updatePrediction();
        }
        lastSecond = seconds;
    }
    
    function updatePrediction() {
        const randomIndex = Math.floor(Math.random() * resultOptions.length);
        document.getElementById('prediction-text').innerText = resultOptions[randomIndex];
    }
    
    // ==================== UI CONTROL FUNCTIONS ====================
    
    window.toggleHide = function() {
        const panel = document.getElementById('main-panel');
        const icon = document.getElementById('floating-icon');
        
        // Store current position
        icon.style.top = panel.style.top;
        icon.style.left = panel.style.left;
        icon.style.transform = panel.style.transform;
        
        panel.style.display = 'none';
        icon.style.display = 'block';
    };
    
    window.toggleShow = function() {
        const panel = document.getElementById('main-panel');
        const icon = document.getElementById('floating-icon');
        
        panel.style.display = 'block';
        icon.style.display = 'none';
    };
    
    window.exitApp = function() {
        location.reload();
    };
    
    // ==================== DRAG FUNCTIONALITY ====================
    
    const panel = document.getElementById('main-panel');
    const icon = document.getElementById('floating-icon');
    
    function makeDraggable(element) {
        let currentX, currentY, initialX, initialY;
        let xOffset = 0, yOffset = 0;
        
        element.addEventListener("mousedown", dragStart);
        element.addEventListener("touchstart", dragStart, {passive: false});
        
        function dragStart(e) {
            // Don't drag if clicking on input or button
            if (e.target.tagName === "INPUT" || e.target.tagName === "BUTTON") return;
            
            e.preventDefault();
            
            if (e.type === "touchstart") {
                initialX = e.touches[0].clientX - xOffset;
                initialY = e.touches[0].clientY - yOffset;
            } else {
                initialX = e.clientX - xOffset;
                initialY = e.clientY - yOffset;
            }
            
            document.addEventListener("mousemove", drag);
            document.addEventListener("mouseup", dragEnd);
            document.addEventListener("touchmove", drag, {passive: false});
            document.addEventListener("touchend", dragEnd);
        }
        
        
        
        function drag(e) {
            e.preventDefault();
            
            if (e.type === "touchmove") {
                currentX = e.touches[0].clientX - initialX;
                currentY = e.touches[0].clientY - initialY;
            } else {
                currentX = e.clientX - initialX;
                currentY = e.clientY - initialY;
            }
            
            xOffset = currentX;
            yOffset = currentY;
            setTranslate(currentX, currentY, element);
        }
        
        function setTranslate(xPos, yPos, el) {
            el.style.transform = "translate3d(" + xPos + "px, " + yPos + "px, 0)";
        }
        
        function dragEnd() {
            initialX = currentX;
            initialY = currentY;
            document.removeEventListener("mousemove", drag);
            document.removeEventListener("mouseup", dragEnd);
            document.removeEventListener("touchmove", drag);
            document.removeEventListener("touchend", dragEnd);
        }
    }
    
    // Make both panel and icon draggable
    makeDraggable(panel);
    makeDraggable(icon);
    
    // ==================== ANIMATION PAGE FUNCTIONS ====================
    
    function startAnimation() {
        const wrapper = document.getElementById('ring-wrapper');
        
        const ringConfig = [
            { size: 160, count: 40, color: '#FF3131', speed: 4 },
            { size: 220, count: 50, color: '#FFFB00', speed: -6 },
            { size: 280, count: 60, color: '#00FF41', speed: 8 },
            { size: 340, count: 70, color: '#00FFFF', speed: -10 },
            { size: 400, count: 80, color: '#FF00FF', speed: 12 }
        ];
        
        ringConfig.forEach((conf) => {
            const ring = document.createElement('div');
            ring.className = 'ring';
            ring.style.width = conf.size + 'px';
            ring.style.height = conf.size + 'px';
            
            const orbit = document.createElement('div');
            orbit.style.position = 'absolute';
            orbit.style.width = '100%';
            orbit.style.height = '100%';
            orbit.style.animation = `rotate ${Math.abs(conf.speed)}s linear infinite`;
            if(conf.speed < 0) orbit.style.animationDirection = 'reverse';
            
            for (let i = 0; i < conf.count; i++) {
                const ball = document.createElement('div');
                ball.className = 'ball';
                ball.style.backgroundColor = conf.color;
                ball.style.color = conf.color;
                
                const angle = (i * (360 / conf.count));
                const radius = conf.size / 2;
                ball.style.position = 'absolute';
                ball.style.top = '50%';
                ball.style.left = '50%';
                ball.style.transform = `rotate(${angle}deg) translate(${radius}px)`;
                
                orbit.appendChild(ball);
            }
            
            ring.appendChild(orbit);
            wrapper.appendChild(ring);
        });
        
        // Add keyframe animation for rotation
        const styleSheet = document.createElement("style");
        styleSheet.innerText = `@keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }`;
        document.head.appendChild(styleSheet);
        
        // Particle effect
        function createParticle() {
            const p = document.createElement('div');
            p.className = 'particle';
            const size = Math.random() * 5 + 2;
            p.style.width = size + 'px';
            p.style.height = size + 'px';
            p.style.left = Math.random() * 100 + '%';
            p.style.top = Math.random() * 100 + '%';
            p.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 70%)`;
            p.style.boxShadow = `0 0 15px currentColor`;
            p.style.opacity = '0';
            p.style.position = 'absolute';
            
            document.getElementById('animation-container').appendChild(p);
            
            p.animate([
                { transform: 'scale(0)', opacity: 0 },
                { transform: 'scale(1.5)', opacity: 1, offset: 0.5 },
                { transform: 'scale(0)', opacity: 0 }
            ], {
                duration: 3000,
                easing: 'ease-in-out'
            }).onfinish = () => p.remove();
        }
        
        setInterval(createParticle, 100);
    }
    
    // ==================== PAGE LOAD AND TRANSITION ====================
    
    window.onload = function() {
        // Start animation
        startAnimation();
        
        // Switch to main page after 5 seconds
        setTimeout(function() {
            document.getElementById('animation-container').classList.add('hidden');
            document.getElementById('index-page').classList.remove('hidden');
        }, 5000);
    };
</script>

</body>
</html>